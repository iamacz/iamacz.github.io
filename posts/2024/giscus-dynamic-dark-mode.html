<!DOCTYPE html>
<html lang="en">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>Giscus - dynamic dark mode - Tangbin Chen</title>
  
    <link rel="shortcut icon" href="/img/MyBlogIcon-bgrm.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="Giscus - dynamic dark mode - Tangbin Chen" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/posts/2024/giscus-dynamic-dark-mode.html" />
  
  <meta property="og:image" content="/img/GISCUS.png" />
  
  <meta property="og:article:published_time" content="2024-07-23T12:01:56.000Z" />
  
  <meta property="og:article:author" content="Tangbin" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
    
<link rel="stylesheet" href="/css/giscus.css">

  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  <script src="/js/imageEnhancements.js"></script>

  <!-- <script src="/js/copy-code.js"></script> -->


  <!-- to add icons from iconfont -->
  <link rel="stylesheet" href="/fonts/iconfont/iconfont.css"> <!-- Ensure this path is correct -->
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> -->
  <link rel="stylesheet" href="/css/index.css"> <!-- Your CSS file -->

  <!-- to import css sinpet -->
  <link rel="stylesheet" href="/css/tocbot.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css" /> -->
  <link rel="stylesheet" href="/css/toc.css"> <!-- Your CSS file -->
  <script src="/js/tocbot.min.js"></script>

  <!-- <link rel="stylesheet" href="/css/murmurs.css"> -->
  <!-- <script src="/js/murmurs.js"></script> -->

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const bodyElement = document.querySelector('body');
    
        // Function to update the giscus theme
        const updateGiscusTheme = (theme) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({
                    giscus: {
                        setConfig: {
                            theme: theme
                        }
                    }
                }, 'https://giscus.app');
            }
        };
    
        // Initial update of giscus theme based on the current data-current-color-scheme
        const initialTheme = bodyElement.getAttribute('data-current-color-scheme');
        updateGiscusTheme(initialTheme);
    
        // MutationObserver to monitor changes to the data-current-color-scheme attribute
        const observer = new MutationObserver((mutationsList) => {
            for (let mutation of mutationsList) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'data-current-color-scheme') {
                    const newTheme = bodyElement.getAttribute('data-current-color-scheme');
                    updateGiscusTheme(newTheme);
                }
            }
        });
    
        // Observe changes to attributes of the body element
        observer.observe(bodyElement, { attributes: true });
    
        // Function to handle the giscus iframe load event
        const handleGiscusLoad = () => {
            const theme = bodyElement.getAttribute('data-current-color-scheme');
            updateGiscusTheme(theme);
        };
    
        // Add an event listener to the giscus iframe load event
        const addIframeLoadListener = () => {
            const giscusIframe = document.querySelector('iframe.giscus-frame');
            if (giscusIframe) {
                giscusIframe.addEventListener('load', handleGiscusLoad);
            }
        };
    
        // Retry adding the load listener if the iframe is not yet loaded
        const retryLoadListener = () => {
            if (!document.querySelector('iframe.giscus-frame')) {
                setTimeout(retryLoadListener, 500);
            } else {
                addIframeLoadListener();
            }
        };
    
        retryLoadListener();
    
    });
    </script>
    

  

  <!-- dynamic margin for toc and post content -->
  <script>
    window.addEventListener('resize', function() {
      var post = document.querySelector('.post');
      var postToc = document.querySelector('.post-toc');
      var windowWidth = window.innerWidth;
  
      if (windowWidth < 800) {
        postToc.style.display = 'none';
        post.style.marginLeft = '0';
        post.style.marginRight = '0';
        post.style.width = '100%';
      } else if (windowWidth < 900) {
        postToc.style.display = 'block';
        post.style.marginLeft = '0';
        post.style.marginRight = '0';
        post.style.width = 'calc(100% - 300px)';
      } else if (windowWidth < 1200) {
        postToc.style.display = 'block';
        post.style.marginLeft = '5%';
        post.style.marginRight = '25%';
        post.style.width = 'auto';
      } else if (windowWidth < 1600) {
        postToc.style.display = 'block';
        post.style.marginLeft = '10%';
        post.style.marginRight = '30%';
        post.style.width = 'auto';
      } else {
        postToc.style.display = 'block';
        post.style.marginLeft = 'auto';
        post.style.marginRight = 'auto';
        post.style.width = 'auto';
      }
    });
  
    // Trigger resize event on page load
    window.dispatchEvent(new Event('resize'));
  </script>

  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>
    <body
        data-color-scheme="light/dark/auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Tangbin&#39;s Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/tags">Tags</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item" href="/projects">Projects</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/tech/">tech</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>July</span>
            <span>23,</span>
            <span>2024</span>
        </div>
        

        <h1 class="title">Giscus - dynamic dark mode</h1>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p>Iâ€™ve been procrastinating for almost a week before I finally realize that I have this blog on my todo list. In this blog, I will show you how I make the theme of my Giscus <strong>dynamically change with the light/dark theme of my blog site</strong> (a front-end laymanâ€™s solution).</p>
<p>As I mentioned in my previous post <a href="/posts/2024/how-i-built-my-blog.html">Born this way - how I built my blog</a>, you can adjust the settings of Gisgus on <a target="_blank" rel="noopener" href="https://giscus.app/">their website</a>.</p>
<p><img src="../../img/Test%20diary/giscus-theme.png" alt="Giscuss theme|500"> </p>
<p><strong><mark style="background: #FFB86CA6;">NOTE</mark></strong>: Before we start, I assume that you already have your blog built in some ways using <strong>Hexo</strong>. <strong>If this is not the case</strong>, then this blog probably can not help you that much.</p>
<h1 id="Body-element-of-light-dark-theme"><a href="#Body-element-of-light-dark-theme" class="headerlink" title="Body element of light/dark theme"></a>Body element of light/dark theme</h1><p>My solution is to fetch the body element that hold the value of current color theme (light or dark) and adjust the theme of Giscus according to the value.</p>
<p>So step 1, we need to <strong><mark style="background: #ADCCFFA6;">find out what is the name of the specific body element</mark></strong>.</p>
<p>First, right click on your blog folder, and click on â€œOpen Git Bash hereâ€. Then you need to starts a local server so that you can preview your blog, you can use the command below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p> Then you can go to <a target="_blank" rel="noopener" href="http://localhost:4000/">http://localhost:4000/</a> for the preview.  When you open the page, press F12 to see the html code of the webpage. Now you can focus on the body elements, and <strong>switch your site from light to dark</strong>. Did you see the changes are highlighted by your browser already? </p>
<p>  <img src="../../img/giscus-dynamic-dark-mode/inspect-my-page.png" alt="Inspect the page|500"></p>
<p>You can see that here two elements of mine changed when I switch the theme:</p>
<ul>
<li>data-color-scheme</li>
<li>data-current-color-scheme</li>
</ul>
<p>The former one holds the value of the theme value input from the toggle on my blog page - light, dark, auto. The latter is the element that holds the value of the current color theme. The difference is that the former can be â€œautoâ€ when switching the theme, and it will be more complex for us to make a function that can understand â€œautoâ€ than take the value of the latter element, which tells you precisely what theme is in use.</p>
<p>You might find your correspond body element with very different name. <strong><mark style="background: #ADCCFFA6;">The core here is to find the one can can tell you what color theme your are using</mark></strong>.</p>
<h1 id="Add-the-JavaScript-snippet-to-your-header"><a href="#Add-the-JavaScript-snippet-to-your-header" class="headerlink" title="Add the JavaScript snippet to your header"></a>Add the JavaScript snippet to your header</h1><p>Then add this script in your head, usually, you can find it in the folder: <code>your-blog/themes/your-theme/layout/_partial</code>. </p>
<p>Remember that you need to replace the â€œdata-current-color-schemeâ€ in the code to the name of the body element that holds the value of the current theme.</p>
<p>Then the automatic syncing should be working~</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">Â  Â  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> bodyElement = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Function to update the giscus theme</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> <span class="title function_">updateGiscusTheme</span> = (<span class="params">theme</span>) =&gt; &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">const</span> iframe = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;iframe.giscus-frame&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (iframe) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  iframe.<span class="property">contentWindow</span>.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="attr">giscus</span>: &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="attr">setConfig</span>: &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="attr">theme</span>: theme</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;, <span class="string">&#x27;https://giscus.app&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Initial update of giscus theme based on the current data-current-color-scheme</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> initialTheme = bodyElement.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-current-color-scheme&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  <span class="title function_">updateGiscusTheme</span>(initialTheme);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// MutationObserver to monitor changes to the data-current-color-scheme attribute</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="function">(<span class="params">mutationsList</span>) =&gt;</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">for</span> (<span class="keyword">let</span> mutation <span class="keyword">of</span> mutationsList) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (mutation.<span class="property">type</span> === <span class="string">&#x27;attributes&#x27;</span> &amp;&amp; mutation.<span class="property">attributeName</span> === <span class="string">&#x27;data-current-color-scheme&#x27;</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">const</span> newTheme = bodyElement.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-current-color-scheme&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="title function_">updateGiscusTheme</span>(newTheme);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Observe changes to attributes of the body element</span></span><br><span class="line">Â  Â  Â  Â  observer.<span class="title function_">observe</span>(bodyElement, &#123; <span class="attr">attributes</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">Â  Â  Â  Â  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h1 id="Giscus-load-for-too-long"><a href="#Giscus-load-for-too-long" class="headerlink" title="Giscus load for too long?"></a>Giscus load for too long?</h1><p>I suffered from the problem that when it takes Gisgus too long to load, the assignment of the initial theme will fail to work. To fix that problem, below is an updated script that also listen to the load event.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">Â  Â  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> bodyElement = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  </span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Function to update the giscus theme</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> <span class="title function_">updateGiscusTheme</span> = (<span class="params">theme</span>) =&gt; &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">const</span> iframe = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;iframe.giscus-frame&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (iframe) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  iframe.<span class="property">contentWindow</span>.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="attr">giscus</span>: &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="attr">setConfig</span>: &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="attr">theme</span>: theme</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;, <span class="string">&#x27;https://giscus.app&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Initial update of giscus theme based on the current data-current-color-scheme</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> initialTheme = bodyElement.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-current-color-scheme&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  <span class="title function_">updateGiscusTheme</span>(initialTheme);</span><br><span class="line">Â  Â  Â  Â  </span><br><span class="line">Â  Â  Â  Â  <span class="comment">// MutationObserver to monitor changes to the data-current-color-scheme attribute</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="function">(<span class="params">mutationsList</span>) =&gt;</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">for</span> (<span class="keyword">let</span> mutation <span class="keyword">of</span> mutationsList) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (mutation.<span class="property">type</span> === <span class="string">&#x27;attributes&#x27;</span> &amp;&amp; mutation.<span class="property">attributeName</span> === <span class="string">&#x27;data-current-color-scheme&#x27;</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">const</span> newTheme = bodyElement.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-current-color-scheme&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="title function_">updateGiscusTheme</span>(newTheme);</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Observe changes to attributes of the body element</span></span><br><span class="line">Â  Â  Â  Â  observer.<span class="title function_">observe</span>(bodyElement, &#123; <span class="attr">attributes</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Function to handle the giscus iframe load event</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> <span class="title function_">handleGiscusLoad</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">const</span> theme = bodyElement.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-current-color-scheme&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="title function_">updateGiscusTheme</span>(theme);</span><br><span class="line">Â  Â  Â  Â  &#125;;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Add an event listener to the giscus iframe load event</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> <span class="title function_">addIframeLoadListener</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">const</span> giscusIframe = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;iframe.giscus-frame&#x27;</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (giscusIframe) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  giscusIframe.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, handleGiscusLoad);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment">// Retry adding the load listener if the iframe is not yet loaded</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">const</span> <span class="title function_">retryLoadListener</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (!<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;iframe.giscus-frame&#x27;</span>)) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="built_in">setTimeout</span>(retryLoadListener, <span class="number">500</span>);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="title function_">addIframeLoadListener</span>();</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;;</span><br><span class="line">Â  Â  Â  Â  <span class="title function_">retryLoadListener</span>();</span><br><span class="line">Â  Â  &#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>Now, enjoy the dynamic theme~ğŸ˜®â€ğŸ’¨</p>

    </div>
    
    <!-- fom chic test  -->
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    // document.ready(function() {
    //     tocbot.init(obj_merge(tocbot_default_config, {
    //         collapseDepth: 1
    //     }));
    // });

    document.addEventListener('DOMContentLoaded', function() {
            tocbot.init(obj_merge(tocbot_default_config, {
                collapseDepth: 1
            }));
        });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    
    <!-- from chic -->
     
    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Tangbin, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/blog/" class="tag">#blog</a><a href="/tags/tech/" class="tag">#tech</a><a href="/tags/experience/" class="tag">#experience</a><a href="/tags/record/" class="tag">#record</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        <a class="next"></a>
        
        <a href="/posts/2024/test-diary" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">Test diary what the name will be?</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="iamacz/iamacz.github.io" data-repo-id="R_kgDOMX21NQ" data-category="Announcements" data-category-id="DIC_kwDOMX21Nc4ChDNc" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async> </script>
        
    
</article>



    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  
        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">About me</h2>
                
                <a href="/about" class="item">About</a>
                
                <a href="/attachment/CHEN Tangbin_CV.pdf" class="item">Resume</a>
                
                <a href="/projects" class="item">Projects</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Contact</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/iamacz" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://space.bilibili.com/2044881377" class="item">X(Twitter)</a>
                
                <a target="_blank" rel="noopener" href="https://space.bilibili.com/2044881377" class="item">bilibili</a>
                
                <a href="/WeChat" class="item">WeChat</a>
                
                <a href="arronchin@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Tangbin<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        <br>
        <span class="footer-extra-description">Le vent se lÃ¨ve, il faut tenter de vivre.</span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>