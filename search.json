[{"title":"Giscus - dynamic dark mode","url":"/posts/2024/giscus-dynamic-dark-mode.html","content":"I've been procrastinating for almost a week before I finally realize that I have this blog on my todo list. In this blog, I will show you how I make the theme of my Giscus **dynamically change with the light/dark theme of my blog site** (a front-end layman's solution).\n\nAs I mentioned in my previous post [Born this way - how I built my blog](/posts/2024/how-i-built-my-blog.html), you can adjust the settings of Gisgus on [their website](https://giscus.app/).\n\n![Giscuss theme|500](../../img/Test%20diary/giscus-theme.png) \n\n<strong><mark style=\"background: #FFB86CA6;\">NOTE</mark></strong>: Before we start, I assume that you already have your blog built in some ways using **Hexo**. **If this is not the case**, then this blog probably can not help you that much.\n# Body element of light/dark theme\n\nMy solution is to fetch the body element that hold the value of current color theme (light or dark) and adjust the theme of Giscus according to the value.\n\nSo step 1, we need to <strong><mark style=\"background: #ADCCFFA6;\">find out what is the name of the specific body element</mark></strong>.\n\nFirst, right click on your blog folder, and click on \"Open Git Bash here\". Then you need to starts a local server so that you can preview your blog, you can use the command below:\n\n```\nhexo s\n```\n\n Then you can go to http://localhost:4000/ for the preview.  When you open the page, press F12 to see the html code of the webpage. Now you can focus on the body elements, and **switch your site from light to dark**. Did you see the changes are highlighted by your browser already? \n \n  ![Inspect the page|500](../../img/giscus-dynamic-dark-mode/inspect-my-page.png)\n\nYou can see that here two elements of mine changed when I switch the theme:\n\n- data-color-scheme\n- data-current-color-scheme\n\nThe former one holds the value of the theme value input from the toggle on my blog page - light, dark, auto. The latter is the element that holds the value of the current color theme. The difference is that the former can be \"auto\" when switching the theme, and it will be more complex for us to make a function that can understand \"auto\" than take the value of the latter element, which tells you precisely what theme is in use.\n\nYou might find your correspond body element with very different name. <strong><mark style=\"background: #ADCCFFA6;\">The core here is to find the one can can tell you what color theme your are using</mark></strong>.\n\n# Add the JavaScript snippet to your header\n\nThen add this script in your head, usually, you can find it in the folder: `your-blog/themes/your-theme/layout/_partial`. \n\nRemember that you need to replace the \"data-current-color-scheme\" in the code to the name of the body element that holds the value of the current theme.\n\nThen the automatic syncing should be working~\n\n```javascript\n<script>\nÂ  Â  document.addEventListener('DOMContentLoaded', () => {\nÂ  Â  Â  Â  const bodyElement = document.querySelector('body');\n  \nÂ  Â  Â  Â  // Function to update the giscus theme\nÂ  Â  Â  Â  const updateGiscusTheme = (theme) => {\nÂ  Â  Â  Â  Â  Â  const iframe = document.querySelector('iframe.giscus-frame');\nÂ  Â  Â  Â  Â  Â  if (iframe) {\nÂ  Â  Â  Â  Â  Â  Â  Â  iframe.contentWindow.postMessage({\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  giscus: {\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setConfig: {\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  theme: theme\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  Â  Â  Â  Â  }, 'https://giscus.app');\nÂ  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  };\n\nÂ  Â  Â  Â  // Initial update of giscus theme based on the current data-current-color-scheme\nÂ  Â  Â  Â  const initialTheme = bodyElement.getAttribute('data-current-color-scheme');\nÂ  Â  Â  Â  updateGiscusTheme(initialTheme);\n\nÂ  Â  Â  Â  // MutationObserver to monitor changes to the data-current-color-scheme attribute\nÂ  Â  Â  Â  const observer = new MutationObserver((mutationsList) => {\nÂ  Â  Â  Â  Â  Â  for (let mutation of mutationsList) {\nÂ  Â  Â  Â  Â  Â  Â  Â  if (mutation.type === 'attributes' && mutation.attributeName === 'data-current-color-scheme') {\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newTheme = bodyElement.getAttribute('data-current-color-scheme');\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateGiscusTheme(newTheme);\nÂ  Â  Â  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  });\n\nÂ  Â  Â  Â  // Observe changes to attributes of the body element\nÂ  Â  Â  Â  observer.observe(bodyElement, { attributes: true });\nÂ  Â  Â  Â  });\n</script>\n```\n\n\n# Giscus load for too long?\n\nI suffered from the problem that when it takes Gisgus too long to load, the assignment of the initial theme will fail to work. To fix that problem, below is an updated script that also listen to the load event.\n\n```javascript\n<script>\nÂ  Â  document.addEventListener('DOMContentLoaded', () => {\nÂ  Â  Â  Â  const bodyElement = document.querySelector('body');\nÂ  Â  Â  Â  \nÂ  Â  Â  Â  // Function to update the giscus theme\nÂ  Â  Â  Â  const updateGiscusTheme = (theme) => {\nÂ  Â  Â  Â  Â  Â  const iframe = document.querySelector('iframe.giscus-frame');\nÂ  Â  Â  Â  Â  Â  if (iframe) {\nÂ  Â  Â  Â  Â  Â  Â  Â  iframe.contentWindow.postMessage({\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  giscus: {\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setConfig: {\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  theme: theme\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  Â  Â  Â  Â  }, 'https://giscus.app');\nÂ  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  };\n\nÂ  Â  Â  Â  // Initial update of giscus theme based on the current data-current-color-scheme\nÂ  Â  Â  Â  const initialTheme = bodyElement.getAttribute('data-current-color-scheme');\nÂ  Â  Â  Â  updateGiscusTheme(initialTheme);\nÂ  Â  Â  Â  \nÂ  Â  Â  Â  // MutationObserver to monitor changes to the data-current-color-scheme attribute\nÂ  Â  Â  Â  const observer = new MutationObserver((mutationsList) => {\nÂ  Â  Â  Â  Â  Â  for (let mutation of mutationsList) {\nÂ  Â  Â  Â  Â  Â  Â  Â  if (mutation.type === 'attributes' && mutation.attributeName === 'data-current-color-scheme') {\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newTheme = bodyElement.getAttribute('data-current-color-scheme');\nÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateGiscusTheme(newTheme);\nÂ  Â  Â  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  });\n\nÂ  Â  Â  Â  // Observe changes to attributes of the body element\nÂ  Â  Â  Â  observer.observe(bodyElement, { attributes: true });\n\nÂ  Â  Â  Â  // Function to handle the giscus iframe load event\nÂ  Â  Â  Â  const handleGiscusLoad = () => {\nÂ  Â  Â  Â  Â  Â  const theme = bodyElement.getAttribute('data-current-color-scheme');\nÂ  Â  Â  Â  Â  Â  updateGiscusTheme(theme);\nÂ  Â  Â  Â  };\n\nÂ  Â  Â  Â  // Add an event listener to the giscus iframe load event\nÂ  Â  Â  Â  const addIframeLoadListener = () => {\nÂ  Â  Â  Â  Â  Â  const giscusIframe = document.querySelector('iframe.giscus-frame');\nÂ  Â  Â  Â  Â  Â  if (giscusIframe) {\nÂ  Â  Â  Â  Â  Â  Â  Â  giscusIframe.addEventListener('load', handleGiscusLoad);\nÂ  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  };\n\nÂ  Â  Â  Â  // Retry adding the load listener if the iframe is not yet loaded\nÂ  Â  Â  Â  const retryLoadListener = () => {\nÂ  Â  Â  Â  Â  Â  if (!document.querySelector('iframe.giscus-frame')) {\nÂ  Â  Â  Â  Â  Â  Â  Â  setTimeout(retryLoadListener, 500);\nÂ  Â  Â  Â  Â  Â  } else {\nÂ  Â  Â  Â  Â  Â  Â  Â  addIframeLoadListener();\nÂ  Â  Â  Â  Â  Â  }\nÂ  Â  Â  Â  };\nÂ  Â  Â  Â  retryLoadListener();\nÂ  Â  });\n\n</script>\n```\n\n\nNow, enjoy the dynamic theme~ğŸ˜®â€ğŸ’¨","tags":["blog","tech","experience","record"],"categories":["tech"]},{"title":"Test diary what the name will be?","url":"/posts/2024/test-diary.html","content":"\n# çµ®å¨\nåªè¦æœ‰ä¸€å¤©æ™šç¡äº†ï¼Œå¥½åƒå°±ä¼šä¸€è¿å¥½å‡ å¤©éƒ½æ²¡åŠæ³•å¥½å¥½ç¡è§‰ã€‚\n\nä¸è¿‡è¿˜æ˜¯è¦å¥½å¥½ç¡è§‰å•¦ï¼Recovery is the key!\n\n# Mathjax\n\nè¯•äº†è¯•mathjaxï¼Œä½†æ˜¯æ ¹æ®MrWillComçš„æ•™ç¨‹ï¼Œæˆ‘çš„å…¬å¼è¿˜æ˜¯æ— æ³•æ˜¾ç¤ºï¼Œæ‰€ä»¥å°±ç¨å¾®æœç´¢äº†ä¸€ä¸‹æ•™ç¨‹ï¼Œçœ‹åˆ°äº†å¾ˆæœ‰ç”¨çš„æ•™ç¨‹ï¼š[Hexoæ¸²æŸ“æ•°å­¦å…¬å¼ï¼šé…ç½®æ–¹æ³•ä¸åŸç†æµ…é‡Š](https://pku-zyf.github.io/formula/)\n\nä¸‹é¢æµ‹è¯•å…¬å¼çš„ç°å®ï¼š\n\n$$\n\\frac{1}{x^2-1}\n$$\né¡ºä¾¿è¯•è¯•çœ‹inline $e=mc^2$\n\næ•ˆæœä¸é”™~\n\n# Giscus\n\nGithub page æœ‰è¶£çš„ä¸œè¥¿çœŸçš„æŒºå¤šçš„ï¼Œä¸‹ä¸€æ­¥å°±å»é…ç½®ä¸€ä¸ªè¯„è®ºåŒºå­ï¼ğŸ¤©\n\næ„Ÿè°¢è¿™ä¸ªæ•™ç¨‹ï¼š[Hugo åšå®¢å¼•å…¥ Giscus è¯„è®ºç³»ç»Ÿ](https://www.lixueduan.com/posts/blog/02-add-giscus-comment/)\n\n\n\n# Hexo + OB + Git\n\n[Hexo + Obsidian + Git å®Œç¾çš„åšå®¢éƒ¨ç½²ä¸ç¼–è¾‘æ–¹æ¡ˆ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7120189614660255781) æ‹œè¯»æ‹œè¯»è¿™ä¸ªå®Œç¾çš„æ•™ç¨‹~\n\n# Vercel?\n[Vercel ï¼Œå¼€ç®±å³ç”¨çš„ç½‘ç«™ç®¡ç†å°å·¥å…· - å°‘æ•°æ´¾ (sspai.com)](https://sspai.com/post/63028)\n\n# test\nI've been procrastinating for almost a week before I finally realize that I have this blog on my todo list. In this blog, I will show you how I make the theme of my Giscus **dynamically change with the light/dark theme of my blog site** (a front-end layman's solution).\n\n![|200](../../img/Test%20diary/giscus-theme.png)\n\n![Beautiful code|500](../../img/Test%20diary/Pasted%20image%2020240803174909.png)","tags":["life"],"categories":["diary"]},{"title":"WeChat","url":"/WeChat/index.html","content":"\nä½ å¥½å–~æˆ‘æƒ³åœ¨è¿™ä¸ªå…¬ä¼—å·è®°å½•æˆ‘çš„å­¦ä¹ æ—…ç¨‹ï¼Œå†…å®¹(ä¹Ÿè®¸ä¼š)åŒ…æ‹¬ç¤¾ä¼šç½‘ç»œåˆ†æï¼ŒåŸºäºç¤¾ä¼šç½‘ç»œçš„å¹²é¢„ï¼Œå› æœåˆ†æï¼ŒåŒä¼´å½±å“(peer influence)ï¼ŒåŒè´¨æ€§(homophily)ã€‚è¯·å¤§å®¶å¤šå¤šå…³æ³¨ï¼Œå¤šå¤šæŒ‡æ•™æ~\n\n![](/img/weixinPublic.png)\n"},{"title":"about","url":"/about/index.html","content":"\n# Tangbin?\n\nHello! This is Tangbin Chen. I sometimes also go by Arron (a name I like but is not used much lately). \n\n![|500](/img/By-the-black-sea.jpg)\n\nI was an engineering student who had always been interested in social questions. Very luckily, I got admitted to a master program in [Computational Social Science](https://liu.se/en/education/program/f7mcd) at LinkÃ¶ping University where I met a lot of interesting people and received my desired training. \n\nAfter my graduation in 2022, I decided to continue studying as a doctoral student and worked at the Institute for Analytical Sociology at LinkÃ¶ping University for another year as research asistant. After that, I was offered a PhD position at Karolinska Institutet to do social epidemiological research. I am very looking forward to my coming journey~\n\nMy main interest is in social influence and network study. My doctoral research will focus on health-related behaviors, especially their diffusion through social networks and network-based intervention.\n# Hobbies?\n\nEvery time being asked about my hobbies, I will be at a loss for a while. It is really hard to summarize what are my hobbies. I like music, movies, novel technologies, travelling, and handcrafts. I like peaceful tea time as well. I also like foods, I like cooking too. I also game sometimes, mainly Genshin Impact. There are so many things I like but I have never attempted to develop one as my hobby (Or maybe I can see it this way that all above are my hobbies). And now I am trying to start blogging as my (new) hobbyğŸ™ˆ\n\n# About this blog...\n\nFirst I would like to send many thanks to [@MrWillCom (Mr. Will)](https://github.com/MrWillCom) and [@Siricee (Liu Zijian)](https://github.com/Siricee) for their excellent templates. And also, I'd like to thank [@DID321 (Di Wang)](https://github.com/DID321) for his tutorial on blogging with [Hexo](https://hexo.io/zh-cn/).\n\nIn this blog, I plan to post something about my life, my thoughts and most importantly to keep a record of my research and study.\n\n# Greetings~\n\nWelcome to my blog!"},{"title":"Projects","url":"/projects/index.html","content":"# Coming soon~"},{"url":"/categories/index.html"},{"url":"/search/index.html"},{"url":"/tags/index.html"}]